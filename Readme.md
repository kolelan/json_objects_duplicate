# Обработчик JSON с удалением дубликатов

Утилита для обработки JSON файлов с автоматическим удалением дубликатов объектов по заданным критериям.

## Возможности

- Поддержка двух структур объектов:
  - Стандартная: `{"name": "значение", "desc": "описание"}`
  - Ключ-значение: `{"ключ": "значение"}`
- Автоматическое определение структуры объектов
- Удаление дубликатов по полю `name`/ключу
- Приоритетная обработка объектов с заполненным описанием
- Предпочтение кириллическим описаниям над латинскими
- Генерация отчета об удаленных дубликатах
- Компактное сохранение результата

## Установка

```bash
git clone <repository-url>
cd <repository-directory>
```

Зависимости: Python 3.6+

## Использование

### Базовое использование

```bash
python main.py input.json
```

### С параметрами

```bash
python main.py input.json -o result.json -r duplicates_report.txt --keep-first
```

### Параметры командной строки

- `input` (обязательный) - входной JSON файл
- `-o, --output` - выходной файл (по умолчанию: `output.json`)
- `-r, --report` - файл отчета (по умолчанию: `report.txt`)
- `-f, --keep-first` - всегда оставлять первый объект, удалять последующие

## Алгоритм обработки дубликатов

1. **Сортировка** объектов по полю `name`/ключу
2. **Группировка** объектов с одинаковыми именами
3. **Выбор лучшего кандидата** в каждой группе:
   - При наличии нескольких объектов предпочтение отдается:
     1. Объектам с заполненным полем `desc`
     2. Объектам с кириллическим описанием
     3. Объектам с латинским описанием
   - При включенном флаге `--keep-first` всегда сохраняется первый объект

## Формат отчетов

Отчет сохраняется в формате TSV с колонками:
- `Line` - номер строки в отсортированном файле
- `Name` - имя объекта
- `Desc` - описание объекта

## Примеры

### Входной файл (input.json)
```json
[
  {"name": "apple", "desc": "фрукт"},
  {"name": "apple", "desc": "fruit"},
  {"name": "banana", "desc": ""}
]
```

### Запуск обработки
```bash
python main.py input.json -o result.json -r report.txt
```

### Результат (result.json)
```json
[
  {"name": "apple", "desc": "фрукт"},
  {"name": "banana", "desc": ""},
  {"name": "fruit", "desc": "orange"}
]
```

### Отчет (report.txt)
```
Line    Name    Desc
2       apple   fruit
3       banana  
```

## Структура проекта

```
.
├── main.py              # Основной скрипт
├── core/
│   ├── processor.py     # Обработка данных
│   ├── reporter.py      # Генерация отчетов
│   └── validator.py     # Валидация и нормализация
├── config/
│   └── settings.py      # Конфигурационные параметры
└── README.md
```

## Конфигурация

Настройки можно изменить в файле `config/settings.py`:

- `NAME_FIELD` - поле для имени объекта
- `DESC_FIELD` - поле для описания
- `DEFAULT_OUTPUT_FILE` - файл для результатов по умолчанию
- `DEFAULT_REPORT_FILE` - файл отчета по умолчанию
- `COMPACT_JSON` - компактный формат JSON

## Обработка ошибок

Программа обрабатывает следующие ошибки:
- Отсутствие входного файла
- Невалидный JSON формат
- Неправильная структура данных (ожидается массив объектов)
- Ошибки записи результатов

## Поддержка

Для вопросов и предложений создавайте issue в репозитории проекта.
